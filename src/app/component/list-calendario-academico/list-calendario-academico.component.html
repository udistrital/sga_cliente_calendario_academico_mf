<mat-card>
  <mat-card-header>
    <mat-card-title>
      {{ "calendario.calendarios_academicos" | translate }}
    </mat-card-title>
  </mat-card-header>
  <mat-card-content>
    <mat-spinner *ngIf="loading" diameter="50" color="primary"></mat-spinner>
    <ng-container
      *ngIf="!loading; else loadingContent"
      style="padding: 0px 2rem"
    >
      <mat-tab-group
        [(selectedIndex)]="activetab"
        (selectedTabChange)="tabChanged($event)"
      >
        <mat-tab label="{{ 'GLOBAL.lista' | translate }}">
          <mat-card>
            <mat-card-content>
              <!-- BUSCADOR Y BOTON -->
              <div
                style="
                  display: flex;
                  justify-content: space-between;
                  flex-wrap: wrap;
                "
              >
                <div
                  class=""
                  style="
                    display: flex;
                    flex: 1;
                    justify-content: flex-end;
                    margin: 0px 1em;
                  "
                >
                  <mat-form-field class="form-field">
                    <mat-label>{{ "GLOBAL.buscar" | translate }}</mat-label>
                    <input
                      matInput
                      type="text"
                      (keyup)="applyFilterProces($event)"
                      placeholder="{{ 'GLOBAL.buscar' | translate }}"
                    />
                  </mat-form-field>
                </div>
                <div
                  style="
                    display: flex;
                    justify-content: flex-start;
                    align-items: center;
                    margin: 0px 0px;
                    margin-bottom: 1.3em;
                  "
                >
                  <button
                    mat-flat-button
                    style="height: 100%"
                    color="accent"
                    type="button"
                    (click)="onCreate($event)"
                  >
                    <mat-icon style="vertical-align: middle" fontIcon="add">
                    </mat-icon>
                    {{ "calendario.tooltip_crear_proceso" | translate }}
                  </button>
                </div>
              </div>
              <!-- TABLA -->
              <div>
                <div class="mat-elevation-z8 table">
                  <table mat-table [dataSource]="dataSource" matSort>
                    <ng-container matColumnDef="Nombre">
                      <th
                        mat-header-cell
                        *matHeaderCellDef
                        mat-sort-header
                        style="width: 25%"
                      >
                        {{ "calendario.nombre" | translate }}
                      </th>
                      <td mat-cell *matCellDef="let row">{{ row.Nombre }}</td>
                    </ng-container>

                    <ng-container matColumnDef="Periodo_AcadÃ©mico">
                      <th
                        mat-header-cell
                        *matHeaderCellDef
                        mat-sort-header
                        style="width: 15%"
                      >
                        {{ "calendario.periodo" | translate }}
                      </th>
                      <td mat-cell *matCellDef="let row">{{ row.Periodo }}</td>
                    </ng-container>

                    <ng-container matColumnDef="Tipo_de_dependencia">
                      <th
                        mat-header-cell
                        *matHeaderCellDef
                        mat-sort-header
                        style="width: 15%"
                      >
                        {{ "calendario.dependencia" | translate }}
                      </th>

                      <td mat-cell *matCellDef="let row">
                        {{ row.Dependencia }}
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="Estado">
                      <th
                        mat-header-cell
                        *matHeaderCellDef
                        mat-sort-header
                        style="width: 15%"
                      >
                        {{ "calendario.estado" | translate }}
                      </th>

                      <td mat-cell *matCellDef="let row">{{ row.Estado }}</td>
                    </ng-container>

                    <ng-container matColumnDef="Acciones">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header>
                        {{ "GLOBAL.acciones" | translate }}
                      </th>
                      <td mat-cell *matCellDef="let row">
                        <button
                          mat-icon-button
                          color="accent"
                          (click)="onAction({ action: 'assign', data: row })"
                        >
                          <mat-icon
                            aria-hidden="false"
                            title="{{
                              'calendario.tooltip_editar' | translate
                            }}"
                            fontIcon="description"
                          ></mat-icon>
                        </button>

                        <button
                          mat-icon-button
                          color="accent"
                          (click)="onAction({action:'clone', data: row,})"
                        >
                          <mat-icon
                            aria-hidden="false"
                            title="{{
                              'calendario.tooltip_clonar' | translate
                            }}"
                            fontIcon="add_circle"
                          ></mat-icon>
                        </button>

                        <button
                          mat-icon-button
                          color="accent"
                          (click)="
                            onAction({
                              action: 'edit',
                              data: row,
                              editable: true
                            })
                          "
                        >
                          <mat-icon
                            aria-hidden="false"
                            title="{{
                              'calendario.tooltip_detalle' | translate
                            }}"
                            fontIcon="home"
                          ></mat-icon>
                        </button>

                        <button
                          mat-icon-button
                          color="accent"
                          (click)="
                            onAction({
                              action: 'edit',
                              data: row,
                              editable: false
                            })
                          "
                        >
                          <mat-icon
                            aria-hidden="false"
                            title="{{
                              'calendario.tooltip_editar' | translate
                            }}"
                            fontIcon="edit"
                          ></mat-icon>
                        </button>

                        <button
                          mat-icon-button
                          color="warn"
                          (click)="onAction({ action: 'delete', data: row })"
                        >
                          <mat-icon
                            aria-hidden="false"
                            title="{{
                              'calendario.tooltip_inactivar' | translate
                            }}"
                            fontIcon="delete"
                          ></mat-icon>
                        </button></td
                    ></ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr
                      mat-row
                      *matRowDef="let row; columns: displayedColumns"
                    ></tr>

                    <!-- Row shown when there is no matching data. -->
                    <tr class="mat-row" *matNoDataRow>
                      <td class="mat-cell" colspan="4">
                        {{ "calendario.sin_procesos" | translate }}
                      </td>
                    </tr>
                  </table>
                  <mat-paginator
                    #paginator
                    [pageSize]="6"
                    [showFirstLastButtons]="true"
                  >
                  </mat-paginator>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </mat-tab>
        <mat-tab label="{{ 'GLOBAL.formulario' | translate }}">
          <mat-card>
            <mat-card-content>
              <def-calendario-academico
                [view]="view"
                [calendarForEditId]="calendarForEditId"
                [calendarForNew]="calendarForNew"
                (calendarCloneOut)="recargarDespuesClon($event)"
              >
              </def-calendario-academico>
            </mat-card-content>
            <mat-card-actions>
              <button mat-flat-button color="primary" (click)="activateTab()">
                <mat-icon>arrow_back</mat-icon>
                {{ "GLOBAL.regresar" | translate }}
              </button>
            </mat-card-actions>
          </mat-card>
        </mat-tab>
      </mat-tab-group>
    </ng-container>
  </mat-card-content>

  <ng-template #loadingContent>
    <mat-card-content>{{ "GLOBAL.cargando" | translate }}</mat-card-content>
  </ng-template>
</mat-card>
